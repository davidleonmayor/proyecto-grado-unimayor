services: # services like the DB, front, back, ETC
  backend:
    image: backend
    container_name: backend
    restart: always
    build:
      context: ./backend
      dockerfile: backend.dockerfile

    environment:
      # - DATABASE_URL=mysql://david:secret@localhost:3306/proyecto_grado
      - DATABASE_URL=mysql://david:secret@db:3306/proyecto_grado # mysql://<user>:<password>@<host>:<port>/<database-name>

    ports:
      - "4000:4000"

  # mysql:
  db: #
    image: mysql:8.0
    # container_name: proyecto_mysql
    container_name: proyecto_mysql
    restart: always
    environment: # MySQL environment variables
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: proyecto_grado
      MYSQL_USER: david
      MYSQL_PASSWORD: secret
    ports:
      - "3306:3306" # [host:container]
    volumes:
      - mysql_data:/var/lib/mysql

volumes: # MySQL data volume
  mysql_data:
